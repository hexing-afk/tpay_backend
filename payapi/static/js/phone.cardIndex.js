define("phone.cardIndex",["up.m.mvc","phone.app","phone.i18"],function(b,a,e){function c(){return this.init.apply(this,arguments)}c.prototype={init:function(a){this.data=a;return this},pageLoad:function(){var c=this;$("#title_tips").text(e.orderPaymentTitle);try{complete()}catch(f){console.log("complete() undefined")}$("#upopNoticeInfo").show();$(".order-list-wrapper").show();c.data&&b.$("#overflow-wrapper").css("margin-left","100%");a.util.hideOrderStatus();a.util.foldOrderDetail();setTimeout(function(){var d=
c.data;d&&(b.$("#main-container").html(b.template.applyTpl(d,{staticURL:a.constants.staticURL,i18:e,qrcode:window.qrParam&&window.qrParam.qrcode?!0:!1})).show(),b.$("#overflow-wrapper").css("margin-left","0%"));a.util.checkEnable($(".form-container .label-input"),$(".btn-wrapper .next"));window.mer_card_tips&&($("#yellow-msg").find(".whiteMerchantCtrl").remove(),$("#yellow-msg").show().append($('<div class="whiteMerchantCtrl">'+window.mer_card_tips+"</div>")).show());$(".op.del").click(function(){b.util.cookie.getcookie("up_b2")&&
b.util.cookie.getcookie("up_b2").split("_")[1]==a.util.trim($(".new-input-wrapper input").val())&&b.util.cookie.setcookie("up_b2","",15552E3,"/");$(this).parent().find("input").val("");$(this).addClass("hide")});$("#cardNumber").upbankcard();$(".fast").click(function(){a.util.pageRoute({route:"userLogin"})});$(".erweima").click(function(){a.util.pageRoute({route:"erweima"})});$("#banklist-pop").click(function(a){a.preventDefault();require(["phone.pop"],function(a){a.popBankList()})});$(".cardbin").click(function(){var c=
a.util.trim($(".new-input-wrapper input").val()),d={cardNumber:c};if(c==""){a.util.toast(e.pleaseInputCardNubmer);return false}if(b.util.cookie.getcookie("up_b2")&&b.util.cookie.getcookie("up_b2").split("_")[1]==c){d.useMemorizedCard=true;d.cardNumber=b.util.cookie.getcookie("up_b2").split("_")[0]}else if(!a.util.luhnChk(c)){a.util.toast(e.shortCardNumber);return false}a.util.loadingStart();b.ajax.post(a.util.buildAjaxRequest({data:d,url:a.constants.requestURL.cardValidateURL,success:function(b){b=
JSON.parse(b);if(b.r!="00"){a.util.hint.init(function(b){a.util.hint.removePop();b.find("a").removeAttr("href");a.util.pageRoute({route:"cardIndex"})},function(){a.util.hint.removePop()},e.changeCard,e.iknow);a.util.loadingFinish();a.util.hint.changeHintText(b.m);a.util.hint.showPop()}else{a.util.finishLoading();a.util.pageRoute(b.p)}},error:function(){console&&console.log("card validate\u5931\u8d25 \uff01")}}))});b.util.cookie.getcookie("up_b2")&&(d=b.util.cookie.getcookie("up_b2").split("_")[1],
$("#cardNumber").val(d));b.$("#slider-wrapper").height(b.$("#main-container").height()+"px")},500);return this}};c.actionLoad=function(a){return(new c(a)).pageLoad()};c.load=function(a){return(new c(a)).pageLoad()};return c});
